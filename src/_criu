#compdef criu

local arguments

arguments=(
  '--no-display-stats[).]'
  '-t[|--tree PID checkpoint a process tree identified by PID]'
  '-d[|--restore-detached detach after restore]'
  '-S[|--restore-sibling restore root task as sibling]'
  '-s[|--leave-stopped leave tasks in stopped state after checkpoint]'
  '-R[|--leave-running leave tasks in running state after checkpoint]'
  '-D[|--images-dir DIR directory for image files]'
  '--pidfile[write root task, service or page-server pid to FILE]'
  '-W[|--work-dir DIR directory to cd and write logs/pidfiles/stats to]'
  '--cpu-cap[CPU capabilities to write/check. CAP is comma-separated]'
  '--exec-cmd[execute the command specified after -- on successful]'
  '--freeze-cgroup[use cgroup freezer to collect processes]'
  '--weak-sysctls[skip restoring sysctls that are not available]'
  '--lazy-pages[restore pages on demand]'
  '--lazy-pages[lazy-pages mode require userfaultfd]'
  '--external[dump objects from this list as external resources:]'
  '--tcp-established[checkpoint/restore established TCP connections]'
  '--skip-in-flight[skip (ignore) in-flight TCP connections]'
  '--tcp-close[restore connected TCP sockets in closed state]'
  '-r[|--root PATH change the root filesystem (when run in mount namespace)]'
  '--evasive-devices[use any path to a device file if the original one]'
  '--link-remap[allow one to link unlinked files back when possible]'
  '--ghost-limit[limit max size of deleted file contents inside image]'
  '--action-script[add an external action script]'
  '-j[|--shell-job allow one to dump and restore shell jobs]'
  '-l[|--file-locks handle file locks, for safety, only used for container]'
  '-L[|--libdir path to a plugin directory (by default /var/lib/criu/)]'
  '--force-irmap[force resolving names for inotify/fsnotify watches]'
  '--irmap-scan-path[add a path the irmap hints to scan]'
  '--manage-cgroups[dump/restore process cgroups; argument can be one of]'
  '--cgroup-root[/newroot]'
  '--cgroup-props[define cgroup controllers and properties]'
  '--cgroup-props-file[same as --cgroup-props, but taking description]'
  '--cgroup-dump-controller[define cgroup controller to be dumped]'
  '--skip-mnt[ignore this mountpoint when dumping the mount namespace]'
  '--enable-fs[a comma separated list of filesystem names or "all"]'
  '--inherit-fd[inherit file descriptors, treating fd NUM as being]'
  '--empty-ns[create a namespace, but dont restore its properties]'
  '-J[|--join-ns NS:{PID|NS_FILE}\[,OPTIONS\]]'
  '--extra[add check for extra kernel features]'
  '--experimental[add check for experimental kernel features]'
  '--all[same as --extra --experimental]'
  '--feature[only check a particular feature, one of:]'
  '-o[|--log-file FILE log file name]'
  '--log-pid[enable per-process logging to separate FILE.pid files]'
  '-v[...\]|--verbosity increase verbosity (can use multiple v)]'
  '-vNUM[|--verbosity=NUM set verbosity to NUM (higher level means more output):]'
  '-v1[only errors and messages]'
  '-v2[also warnings (default level)]'
  '-v3[also information messages and timestamps]'
  '-v4[lots of debug]'
  '--display-stats[print out dump/restore stats]'
  '--track-mem[turn on memory changes tracker in kernel]'
  '--prev-images-dir[path to images from previous dump (relative to -D)]'
  '--page-server[send pages to page server (see options below as well)]'
  '--auto-dedup[when used on dump it will deduplicate "old" data in]'
  '--address[address of server or service]'
  '--port[port of page server]'
  '--ps-socket[use specified FD as page server socket]'
  '-d[|--daemon run in the background after creating socket]'
  '--status-fd[write \0 to the FD and close it once process is ready]'
  '--config[pass a specific configuration file]'
  '--no-default-config[forbid usage of default configuration files]'
  '-h[|--help show this text]'
  '-V[|--version show version]'
  '*:filename:_files'
)

_arguments -s $arguments
