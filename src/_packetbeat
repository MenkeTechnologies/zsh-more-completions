#compdef packetbeat

local arguments

arguments=(
  {-E,--E}'[Configuration overwrite]'
  {-I,--I}'[read packet data from specified file]'
  {-N,--N}'[disable actual publishing for testing]'
  {-O,--O}'[read packets one at a time (press Enter)]'
  {-c,--c}'[configuration file, relative to path.config (default "packetbeat.yml")]'
  '--cpuprofile[write cpu profile to file]'
  {-d,--d}'[enable certain debug selectors]'
  '--dump[write all captured packets to this libpcap file]'
  {-e,--e}'[log to stderr and disable syslog/file output]'
    '(- * :)'{-h,--help}'[help for packetbeat]'
  '--httpprof[start pprof http server]'
  {-l,--l}'[loop file. 0 - loop forever (default 1)]'
  '--memprofile[write memory profile to this file]'
  '--path.config[Configuration path (default "")]'
  '--path.data[Data path (default "")]'
  '--path.home[Home path (default "")]'
  '--path.logs[Logs path (default "")]'
  '--plugin[load additional plugins]'
  '--setup[load sample Kibana dashboards and setup Machine Learning]'
  '--strict[Strict permission checking on config files (default true)]:perms'
  {-t,--t}'[read packets as fast as possible, without sleeping]'
  {-v,--v}'[log at INFO level]'
  '*:filename:_files'
)

_arguments -s $arguments
