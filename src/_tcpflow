#compdef tcpflow

local arguments

arguments=(
  '-a[do ALL post-processing.]'
  '-b[max number of bytes per flow to save]'
  '-d[debug level; default is 1]'
  '-f[maximum number of file descriptors to use]'
  '-h[print this help message (-hh for more help)]'
  '-H[print detailed information about each scanner]'
  '-i[network interface on which to listen]'
  '-I[write for each flow another file *.findx to provide byte-indexed timestamps]'
  '-g[output each flow in alternating colors (note change!)]'
  '-l[treat non-flag arguments as input files rather than a pcap expression]'
  '-L[semlock - specifies that writes are locked using a named semaphore]'
  '-p[dont use promiscuous mode]'
  '-q[quiet mode - do not print warnings]'
  '-r[read packets from tcpdump pcap file (may be repeated)]'
  '-R[read packets from tcpdump pcap file TO FINISH CONNECTIONS]'
  '-v[verbose operation equivalent to -d 10]'
  '-V[print version number and exit]'
  '-w[file : write packets not processed to file]'
  '-o[outdir : specify output directory (default .)]'
  '-X[filename : DFXML output to filename]'
  '-m[bytes : specifies skip that starts a new stream (default 16777216).]'
  '-F[{p} : filename prefix/suffix (-hh for options)]'
  '-T[{t} : filename template (-hh for options; default %A.%a-%B.%b%V%v%C%c)]'
  '-Z[do not decompress gzip-compressed HTTP transactions]'
  '-U[relinquish privleges and become user (if running as root)]'
  '-z[chroot to dir (requires that -U be used).]'
  '-E[turn off all scanners except scanner]'
  '-S[value Set a configuration parameter (-hh for info)]'
  '-B[binary output, even with -c or -C (normally -c or -C turn it off)]'
  '-c[console print only (dont create files)]'
  '-C[console print only, but without the display of source/dest header]'
  '-0[dont print newlines after packets when printing to console]'
  '-s[strip non-printable characters (change to .)]'
  '-D[output in hex (useful to combine with -c or -C)]'
  '*:filename:_files'
)

_arguments -s $arguments
