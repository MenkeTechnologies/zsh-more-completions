#compdef cryptsetup

local arguments

arguments=(
  '--version[print package version]'
  {-v,--verbose}'[shows more detailed error messages]'
  '--debug[show debug messages]'
  {-c,--cipher}'[the cipher used to encrypt the disk]'
  {-h,--hash}'[the hash used to create the encryption]'
  {-y,--verify-passphrase}'[verifies the passphrase by asking for]'
  {-d,--key-file}'[read the key from a file.]'
  '--master-key-file[read the volume (master) key from file.]'
  '--dump-master-key[dump volume (master) key instead of]'
  {-s,--key-size}'[the size of the encryption key]'
  {-l,--keyfile-size}'[limits the read from keyfile]'
  '--keyfile-offset[number of bytes to skip in keyfile]'
  '--new-keyfile-size[limits the read from newly added]'
  '--new-keyfile-offset[number of bytes to skip in newly added]'
  {-S,--key-slot}'[slot number for new key (default is]'
  {-b,--size}'[the size of the device]'
  {-o,--offset}'[the start offset in the backend device]'
  {-p,--skip}'[how many sectors of the encrypted data]'
  {-r,--readonly}'[create a readonly mapping]'
  {-q,--batch-mode}'[do not ask for confirmation]'
  {-t,--timeout}'[timeout for interactive passphrase]'
  '--progress-frequency[progress line update (in seconds)]'
  {-T,--tries}'[how often the input of the passphrase]'
  '--align-payload[align payload at <n> sector boundaries]'
  '--header-backup-file[file with LUKS header and keyslots]'
  '--use-random[use /dev/random for generating volume]'
  '--use-urandom[use /dev/urandom for generating volume]'
  '--shared[share device with another]'
  '--uuid[UUID for device to use.]'
  '--allow-discards[allow discards (aka TRIM) requests for]'
  '--header[device or file with separated LUKS]'
  '--test-passphrase[do not activate device, just check]'
  '--tcrypt-hidden[use hidden header (hidden TCRYPT]'
  '--tcrypt-system[device is system TCRYPT drive (with]'
  '--tcrypt-backup[use backup (secondary) TCRYPT header.]'
  '--veracrypt[scan also for VeraCrypt compatible]'
  '--veracrypt-pim[personal Iteration Multiplier for]'
  '--veracrypt-query-pim[query Personal Iteration Multiplier]'
  {-M,--type}'[type of device metadata: luks, plain]'
  '--force-password[disable password quality check (if]'
  '--perf-same[_cpu_crypt Use dm-crypt same_cpu_crypt]'
  '--perf-submit[_from_crypt_cpus Use dm-crypt submit_from_crypt_cpus]'
  '--deferred[device removal is deferred until the]'
  {-i,--iter-time}'[PBKDF iteration time for LUKS (in ms)]'
  '--pbkdf[PBKDF algorithm (for LUKS2)]'
  '--pbkdf-memory[PBKDF memory cost limit]'
  '--pbkdf-parallel[PBKDF parallel cost]'
  '--pbkdf-force-iterations[PBKDF iterations cost (forced]'
  '--priority[keyslot priority (ignore/normal/prefer)]'
  '--disable-locks[disable locking of on-disk metadata]'
  '--disable-keyring[disable loading volume keys via kernel]'
  {-I,--integrity}'[data integrity algorithm (LUKS2 only)]'
  '--integrity-no-journal[disable journal for integrity device.]'
  '--integrity-no-wipe[do not wipe device after format]'
  '--token-only[do not ask for passphrase if]'
  '--token-id[token number (default: any)]'
  '--key-description[key description]'
  '--sector-size[encryption sector size (default: 512]'
  '--persistent[set activation flags persistent for]'
  '--label[set label for the LUKS2 device.]'
  '--subsystem[set subsystem label for the LUKS2]'
  '--usage[display brief usage]'
  '*:filename:_files'
)

_arguments -s $arguments
