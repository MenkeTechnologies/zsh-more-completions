#compdef binwalk

local arguments

arguments=(
  {-B,--signature}'[scan target file(s) for common file signatures]'
  {-R,--raw}'[scan target file(s) for the specified sequence of bytes]'
  {-A,--opcodes}'[scan target file(s) for common executable opcode signatures]'
  {-m,--magic}'[specify a custom magic file to use]'
  {-b,--dumb}'[disable smart signature keywords]'
  {-I,--invalid}'[show results marked as invalid]'
  {-x,--exclude}'[exclude results that match <str>]'
  {-y,--include}'[only show results that match <str>]'
  {-e,--extract}'[automatically extract known file types]'
  {-D,--dd}'[extract <type> signatures, give the files an extension of <ext>, and execute <cmd>]'
  {-M,--matryoshka}'[recursively scan extracted files]'
  {-d,--depth}'[limit matryoshka recursion depth (default: 8 levels deep)]'
  {-C,--directory}'[extract files/folders to a custom directory (default: current working directory)]'
  {-j,--size}'[limit the size of each extracted file]'
  {-n,--count}'[limit the number of extracted files]'
  {-r,--rm}'[delete carved files after extraction]'
  {-z,--carve}'[carve data from files, but dont execute extraction utilities]'
  {-V,--subdirs}'[extract into sub-directories named by the offset]'
  {-E,--entropy}'[calculate file entropy]'
  {-F,--fast}'[use faster, but less detailed, entropy analysis]'
  {-J,--save}'[save plot as a PNG]'
  {-Q,--nlegend}'[omit the legend from the entropy plot graph]'
  {-N,--nplot}'[do not generate an entropy plot graph]'
  {-H,--high}'[set the rising edge entropy trigger threshold (default: 0.95)]'
  {-L,--low}'[set the falling edge entropy trigger threshold (default: 0.85)]'
  {-W,--hexdump}'[perform a hexdump / diff of a file or files]'
  {-G,--green}'[only show lines containing bytes that are the same among all files]'
  {-i,--red}'[only show lines containing bytes that are different among all files]'
  {-U,--blue}'[only show lines containing bytes that are different among some files]'
  {-w,--terse}'[diff all files, but only display a hex dump of the first file]'
  {-X,--deflate}'[scan for raw deflate compression streams]'
  {-Z,--lzma}'[scan for raw LZMA compression streams]'
  {-P,--partial}'[perform a superficial, but faster, scan]'
  {-S,--stop}'[stop after the first result]'
  {-l,--length}'[number of bytes to scan]'
  {-o,--offset}'[start scan at this file offset]'
  {-O,--base}'[add a base address to all printed offsets]'
  {-K,--block}'[set file block size]'
  {-g,--swap}'[reverse every n bytes before scanning]'
  {-f,--log}'[log results to file]'
  {-c,--csv}'[log results to file in CSV format]'
  {-t,--term}'[format output to fit the terminal window]'
  {-q,--quiet}'[suppress output to stdout]'
  {-v,--verbose}'[enable verbose output]'
  '(- * :)'{-h,--help}'[show help output]'
  {-a,--finclude}'[only scan files whose names match this regex]'
  {-p,--fexclude}'[do not scan files whose names match this regex]'
  {-s,--status}'[enable the status server on the specified port]'
  '*:filename:_files'
)

_arguments -s $arguments
