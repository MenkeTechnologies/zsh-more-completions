#compdef iptables-legacy

local arguments

arguments=(
  {--append,-A}'[append to chain]'
  {--check,-C}'[check for the existence of a rule]'
  {--delete,-D}'[delete matching rule from chain]'
  {--delete,-D}'[rulenum]'
  {--insert,-I}'[\[rulenum\]]'
  {--replace,-R}'[rulenum]'
  {--list,-L}'[\[rulenum\]\]]'
  {--list-rules,-S}'[\[rulenum\]\]]'
  {--flush,-F}'[delete all rules in chain or all chains]'
  {--zero,-Z}'[\[rulenum\]\]]'
  {--new,-N}'[create a new user-defined chain]'
  '--delete-chain[]'
  '-X[delete a user-defined chain]'
  {--policy,-P}'[target]'
  '--rename-chain[]'
  '-E[new-chain]'
  {--ipv4,-4}'[nothing (line is ignored by ip6tables-restore)]'
  {--ipv6,-6}'[error (line is ignored by iptables-restore)]'
  {--jump,-j}'[target for rule (may load target extension)]'
  {--goto,-g}'[jump to chain with no return]'
  {--match,-m}'[extended match (may load extension)]'
  {--numeric,-n}'[numeric output of addresses and ports]'
  {--table,-t}'[table to manipulate (default: `filter)]'
  {--verbose,-v}'[verbose mode]'
  {--wait,-w}'[maximum wait to acquire xtables lock before give up]'
  {--wait-interval,-W}'[wait time to try to acquire xtables lock]'
  '--line-numbers[print line numbers when listing]'
  {--exact,-x}'[expand numbers (display exact values)]'
  '--modprobe[try to insert modules using this command]'
  '--set-counters[BYTES set the counter during insert/append]'
  '*:filename:_files'
)

_arguments -s $arguments
