#compdef tshark

local arguments

arguments=(
    '-i[name or idx of interface (def: first non-loopback)]'
    '-f[filter> packet filter in libpcap filter syntax]'
    '-s[packet snapshot length (def: appropriate maximum)]'
    '-p[do not capture in promiscuous mode]'
    '-I[capture in monitor mode, if available]'
    '-B[size> size of kernel buffer (def: 2MB)]'
    '-y[type> link layer type (def: first appropriate)]'
    '-D[print list of interfaces and exit]'
    '-L[print list of link-layer types of iface and exit]'
    '-c[count> stop after n packets (def: infinite)]'
    '-a[cond.> ... duration:NUM - stop after NUM seconds]'
    '-b[opt.> ... duration:NUM - switch to next file after NUM secs]'
    '-r[set the filename to read from (- to read from stdin)]'
    '-2[perform a two-pass analysis]'
    '-M[count> perform session auto reset]'
    '-R[filter> packet Read filter in Wireshark display filter syntax]'
    '-Y[filter> packet displaY filter in Wireshark display filter]'
    '-n[disable all name resolutions (def: all enabled)]'
    '-N[resolve flags> enable specific name resolution(s): "mnNtCd"]'
    '-d[<selector>,<decode_as_protocol> ...]'
    '-H[file> read a list of entries from a hosts file, which will]'
    '--enable-protocol[enable dissection of proto_name]'
    '--disable-protocol[disable dissection of proto_name]'
    '--enable-heuristic[enable dissection of heuristic protocol]'
    '--disable-heuristic[disable dissection of heuristic protocol]'
    '-w[write packets to a pcap-format file named "outfile"]'
    '-C[profile> start with specified configuration profile]'
    '-F[file type> set the output file type, default is pcapng]'
    '-V[add output of packet tree (Packet Details)]'
    '-O[Only show packet details of these protocols, comma]'
    '-P[print packet summary even when writing to a file]'
    '-S[the line separator to print between packets]'
    '-x[add output of hex and ASCII dump (Packet Bytes)]'
    '-T[format of text output (def: text)]'
    '-j[protocols layers filter if -T ek|pdml|json selected]'
    '-J[top level protocol filter if -T ek|pdml|json selected]'
    '-e[field to print if -Tfields selected (e.g. tcp.port]'
    '-E[<fieldsoption>=<value> set options for output when -Tfields selected:]'
    '-t[output format of time stamps (def: r: rel. to first)]'
    '-u[output format of seconds (def: s: seconds)]'
    '-l[flush standard output after each packet]'
    '-q[be more quiet on stdout (e.g. when using statistics)]'
    '-Q[only log true errors to stderr (quieter than -q)]'
    '-g[enable group read access on the output file(s)]'
    '-W[Save extra information in the file, if supported.]'
    '-X[eXtension options, see the man page for details]'
    '-U[PDUs export mode, see the man page for details]'
    '-z[various statistics, see the man page for details]'
    '--capture-comment[add a capture comment to the newly created]'
    '--export-objects[save exported objects for a protocol to]:destdir:'
    '-h[display this help and exit]'
    '-v[display version info and exit]'
    '-o[... override preference setting]'
    '-K[keytab file to use for kerberos decryption]'
    '-G[dump one of several available reports and exit]'
    '*:filename:_files'
)

_arguments -s $arguments
