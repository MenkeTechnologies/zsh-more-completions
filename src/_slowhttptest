#compdef slowhttptest

local arguments

arguments=(
  '-H[slow headers a.k.a. Slowloris (default)]'
  '-B[slow body a.k.a R-U-Dead-Yet]'
  '-R[range attack a.k.a Apache killer]'
  '-X[slow read a.k.a Slow Read]'
  '-g[generate statistics with socket state changes (off)]'
  '-o[save statistics output in file.html and file.csv (-g required)]'
  '-v[verbosity level 0-4: Fatal, Info, Error, Warning, Debug]'
  '-c[target number of connections (50)]'
  '-i[interval between followup data in seconds (10)]'
  '-l[target test length in seconds (240)]'
  '-r[connections per seconds (50)]'
  '-s[value of Content-Length header if needed (4096)]'
  '-t[verb to use in request, default to GET for]'
  '-u[absolute URL of target (http://localhost/)]'
  '-x[max length of each randomized name/value pair of]'
  '-f[value of Content-type header (application/x-www-form-urlencoded)]'
  '-m[value of Accept header (text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5)]'
  '-d[all traffic directed through HTTP proxy at host:port (off)]'
  '-e[probe traffic directed through HTTP proxy at host:port (off)]'
  '-p[timeout to wait for HTTP response on probe connection]'
  '-a[left boundary of range in range header (5)]'
  '-b[limit for range header right boundary values (2000)]'
  '-k[number of times to repeat same request in the connection. Use to]'
  '-n[interval between read operations from recv buffer in seconds (1)]'
  '-w[start of the range advertised window size would be picked from (1)]'
  '-y[end of the range advertised window size would be picked from (512)]'
  '-z[bytes to slow read from receive buffer with single read() call (5)]'
  '*:filename:_files'
)

_arguments -s $arguments
