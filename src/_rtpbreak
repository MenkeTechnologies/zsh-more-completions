#compdef rtpbreak

local arguments

arguments=(
  '-r[read packets from pcap file <str>]'
  '-i[read packets from network interface <str>]'
  '-L[force datalink header length == <int> bytes]'
  '-d[set output directory to <str> (def:.)]'
  '-w[disable RTP raw dumps]'
  '-W[disable RTP pcap dumps]'
  '-g[fill gaps in RTP raw dumps (caused by lost packets)]'
  '-n[dump noise packets]'
  '-f[disable stdout logging]'
  '-F[enable syslog logging]'
  '-v[be verbose]'
  '-m[sniff packets in promisc mode]'
  '-p[add pcap filter <str>]'
  '-e[expect even destination UDP port]'
  '-u[expect unprivileged source/destination UDP ports (>1024)]'
  '-y[expect RTP payload type == <int>]'
  '-l[expect RTP payload length == <int> bytes]'
  '-t[set packet timeout to <float> seconds (def:10.00)]'
  '-T[set pattern timeout to <float> seconds (def:0.25)]'
  '-P[set pattern packets count to <int> (def:5)]'
  '-Z[run as user <str>]'
  '-D[run in background (option -f implicit)]'
  '-k[list known RTP payload types]'
  '-h[this]'
  '*:filename:_files'
)

_arguments -s $arguments
