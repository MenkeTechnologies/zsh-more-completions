#compdef iperf3

local arguments

arguments=(
  {-p,--port}'[# server port to listen on/connect to]'
  {-f,--format}'[\[kmgtKMGT\] format to report: Kbits, Mbits, Gbits, Tbits]'
  {-i,--interval}'[# seconds between periodic throughput reports]'
  {-F,--file}'[xmit/recv the specified file]'
  {-B,--bind}'[bind to the interface associated with the address <host>]:host:'
  {-V,--verbose}'[more detailed output]'
  {-J,--json}'[output in JSON format]'
  '--logfile[send output to a log file]'
  '--forceflush[force flushing output at every interval]'
  {-d,--debug}'[emit debugging output]'
  {-v,--version}'[show version information and quit]'
  '(- * :)'{-h,--help}'[show this message and quit]'
  {-s,--server}'[run in server mode]'
  {-D,--daemon}'[run the server as a daemon]'
  {-I,--pidfile}'[write PID file]'
  {-1,--one-off}'[handle one client connection then exit]'
  '--rsa-private-key-path[path to the RSA private key used to decrypt]'
  '--authorized-users-path[path to the configuration file containing user]'
  {-c,--client}'[run in client mode, connecting to <host>]:host:'
  {-u,--udp}'[use UDP rather than TCP]'
  '--connect-timeout[timeout for control connection setup (ms)]'
  {-b,--bitrate}'[/#\] target bitrate in bits/sec (0 for unlimited)]'
  '--pacing-timer[set the timing for pacing, in microseconds (default 1000)]'
  {-t,--time}'[# time in seconds to transmit for (default 10 secs)]'
  {-n,--bytes}'[#\[KMG\] number of bytes to transmit (instead of -t)]'
  {-k,--blockcount}'[number of blocks (packets) to transmit (instead of -t or -n)]'
  {-l,--length}'[#\[KMG\] length of buffer to read or write]'
  '--cport[bind to a specific client port (TCP and UDP, default: ephemeral port)]:port:'
  {-P,--parallel}'[# number of parallel client streams to run]'
  {-R,--reverse}'[run in reverse mode (server sends, client receives)]'
  {-w,--window}'[#\[KMG\] set window size / socket buffer size]'
  {-M,--set-mss}'[# set TCP/SCTP maximum segment size (MTU - 40 bytes)]'
  {-N,--no-delay}'[set TCP/SCTP no delay, disabling Nagles Algorithm]'
  {-4,--version4}'[only use IPv4]'
  {-6,--version6}'[only use IPv6]'
  {-S,--tos}'[set the IP type of service, 0-255.]'
  '--dscp[or --dscp val set the IP dscp value, either 0-63 or symbolic.]'
  {-Z,--zerocopy}'[use a zero copy method of sending data]'
  {-O,--omit}'[omit the first n seconds]'
  {-T,--title}'[prefix every output line with this string]'
  '--extra-data[data string to include in client and server JSON]'
  '--get-server-output[get results from server]'
  '--udp-counters-64bit[use 64-bit counters in UDP test packets]'
  '--repeating-payload[use repeating pattern in payload, instead of]'
  '--username[username for authentication]'
  '--rsa-public-key-path[path to the RSA public key used to encrypt]'
  '*:filename:_files'
)

_arguments -s $arguments
