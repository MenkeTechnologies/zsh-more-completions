#compdef tcprewrite

local arguments

arguments=(
  {-r,--portmap}'[rewrite TCP/UDP ports]'
  {-s,--seed}'[randomize src/dst IPv4/v6 addresses w/ given seed]'
  {-N,--pnat}'[rewrite IPv4/v6 addresses using pseudo-NAT]'
  {-S,--srcipmap}'[rewrite source IPv4/v6 addresses using pseudo-NAT]'
  {-D,--dstipmap}'[rewrite destination IPv4/v6 addresses using pseudo-NAT]'
  {-e,--endpoints}'[rewrite IP addresses to be between two endpoints]'
  {-b,--skipbroadcast}'[skip rewriting broadcast/multicast IPv4/v6 addresses]'
  {-C,--fixcsum}'[force recalculation of IPv4/TCP/UDP header checksums]'
  {-m,--mtu}'[override default MTU length (1500 bytes)]'
  '--mtu-trunc[truncate packets larger then specified MTU]'
  {-E,--efcs}'[remove Ethernet checksums (FCS) from end of frames]'
  '--ttl[modify the IPv4/v6 TTL/Hop Limit]'
  '--tos[set the IPv4 TOS/DiffServ/ECN byte]'
  '--tclass[set the IPv6 Traffic Class byte]'
  '--flowlabel[set the IPv6 Flow Label]'
  {-F,--fixlen}'[pad or truncate packet data to match header length]'
  '--fuzz-seed[fuzz 1 in X packets. Edit bytes, length, or emulate packet drop]'
  '--fuzz-factor[set the Fuzz 1 in X packet ratio (default 1 in 8 packets)]'
  '--skipl2broadcast[skip rewriting broadcast/multicast Layer 2 addresses]'
  '--dlt[override output DLT encapsulation]'
  '--enet-dmac[override destination ethernet MAC addresses]'
  '--enet-smac[override source ethernet MAC addresses]'
  '--enet-subsmac[substitute MAC addresses]'
  '--enet-mac-seed[randomize MAC addresses]'
  '--enet-mac-seed-keep-bytes[randomize MAC addresses]'
  '--enet-vlan[specify ethernet 802.1q VLAN tag mode]'
  '--enet-vlan-tag[specify the new ethernet 802.1q VLAN tag value]'
  '--enet-vlan-cfi[specify the ethernet 802.1q VLAN CFI value]'
  '--enet-vlan-pri[specify the ethernet 802.1q VLAN priority]'
  '--hdlc-control[specify HDLC control value]'
  '--hdlc-address[specify HDLC address]'
  '--user-dlt[set output file DLT type]'
  '--user-dlink[rewrite Data-Link layer with user specified data]'
  {-d,--dbug}'[enable debugging output]'
  {-i,--infile}'[input pcap file to be processed]'
  {-o,--outfile}'[output pcap file]'
  {-c,--cachefile}'[split traffic via tcpprep cache file]'
  {-v,--verbose}'[print decoded packets via tcpdump to STDOUT]'
  {-A,--decode}'[arguments passed to tcpdump decoder]'
  '--skip-soft-errors[skip writing packets with soft errors]'
  {-V,--version}'[print version information]'
  {-h,--less-help}'[display less usage information and exit]'
  {-H,--help}'[display extended usage information and exit]'
  '--save-opts[save the option state to a config file]'
  '--load-opts[load options from a config file]'
  '*:filename:_files'
)

_arguments -s $arguments
