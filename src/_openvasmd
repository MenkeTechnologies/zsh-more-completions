#compdef openvasmd

local arguments

arguments=(
  '(- * :)'{-h,--help}'[show help options]'
  '--backup[backup the database.]'
  '--check-alerts[check SecInfo alerts.]'
  '--client-watch-interval[check if client connection was closed every <number> seconds. 0 to disable. Defaults to 1 seconds.]'
  {-d,--database}'[/name> Use <file/name> as database for SQLite/Postgres.]'
  '--disable-cmds[disable comma-separated <commands>.]'
  '--disable-encrypted-credentials[do not encrypt or decrypt credentials.]'
  '--disable-password-policy[do not restrict passwords to the policy.]'
  '--disable-scheduling[disable task scheduling.]'
  '--create-user[create admin user <username> and exit.]'
  '--delete-user[delete user <username> and exit.]'
  '--get-users[list users and exit.]'
  '--create-scanner[create global scanner <scanner> and exit.]'
  '--modify-scanner[modify scanner <scanner-uuid> and exit.]'
  '--scanner-name[name for --modify-scanner.]'
  '--scanner-host[scanner host for --create-scanner and --modify-scanner. Default is /var/run/openvassd.sock.]'
  '--otp-scanner[path to scanner unix socket file. Used by --rebuild and --update]'
  '--scanner-port[scanner port for --create-scanner and --modify-scanner. Default is 9391.]'
  '--scanner-type[scanner type for --create-scanner and --mdoify-scanner. Either OpenVAS or OSP.]'
  '--scanner-ca-pub[scanner CA Certificate path for --\[create|modify\]-scanner.]'
  '--scanner-key-pub[scanner Certificate path for --\[create|modify\]-scanner.]'
  '--scanner-key-priv[scanner private key path for --\[create|modify\]-scanner.]'
  '--verify-scanner[verify scanner <scanner-uuid> and exit.]'
  '--delete-scanner[delete scanner <scanner-uuid> and exit.]'
  '--get-scanners[list scanners and exit.]'
  '--schedule-timeout[time out tasks that are more than <time> minutes overdue. -1 to disable, 0 for minimum time, default: 60]'
  {-f,--foreground}'[run in foreground.]'
  '--inheritor[have <username> inherit from deleted user.]'
  {-a,--listen}'[listen on <address>.]'
  '--listen2[listen also on <address>.]'
  '--listen-owner[owner of the unix socket]'
  '--listen-group[group of the unix socket]'
  '--listen-mode[file mode of the unix socket]'
  '--max-ips-per-target[maximum number of IPs per target.]'
  '--max-email-attachment-size[maximum size of alert email attachments, in bytes.]'
  '--max-email-include-size[maximum size of inlined content in alert emails, in bytes.]'
  '--max-email-message-size[maximum size of user-defined message text in alert emails, in bytes.]'
  {-m,--migrate}'[migrate the database and exit.]'
  '--modify-setting[modify setting <uuid> and exit.]'
  '--encrypt-all-credentials[(Re-)Encrypt all credentials.]'
  '--new-password[modify users password and exit.]'
  '--optimize[run an optimization: vacuum, analyze, cleanup-config-prefs, remove-open-port-results, cleanup-port-names, cleanup-result-severities, cleanup-schedule-times, rebuild-report-cache or update-report-cache.]'
  '--password[password, for --create-user.]'
  {-p,--port}'[use port number <number>.]'
  '--port2[use port number <number> for address 2.]'
  '--progress[display progress during --rebuild and --update.]'
  '--rebuild[rebuild the NVT cache and exit.]'
  '--role[role for --create-user and --get-users.]'
  {-u,--update}'[update the NVT cache and exit.]'
  {-c,--unix-socket}'[listen on UNIX socket at <filename>.]'
  '--user[user for --new-password.]'
  '--gnutls-priorities[sets the GnuTLS priorities for the Manager socket.]'
  '--dh-params[diffie-Hellman parameters file]'
  '--value[value for --modify-setting.]'
  {-v,--verbose}'[has no effect. See INSTALL for logging config.]'
  '--version[print version and exit.]'
  '*:filename:_files'
)

_arguments -s $arguments
