#compdef zmap

local arguments

arguments=(
  {-p,--target-port}'[port number to scan (for TCP and UDP scans)]'
  {-o,--output-file}'[output file]'
  {-b,--blacklist-file}'[file of subnets to exclude, in CIDR notation]'
  {-w,--whitelist-file}'[file of subnets to constrain scan to, in CIDR]'
  {-r,--rate}'[set send rate in packets/sec]'
  {-B,--bandwidth}'[set send rate in bits/second (supports suffixes]'
  {-n,--max-targets}'[cap number of targets to probe (as a number or]'
  {-t,--max-runtime}'[cap length of time for sending packets]'
  {-N,--max-results}'[cap number of results to return]'
  {-P,--probes}'[number of probes to send to each IP]'
  {-c,--cooldown-time}'[how long to continue receiving after sending]'
  {-e,--seed}'[seed used to select address permutation]'
  '--retries[max number of times to try to send packet if]'
  {-d,--dryrun}'[dont actually send packets]'
  '--shards[set the total number of shards (default=`1)]'
  '--shard[set which shard this scan is (0 indexed)]'
  {-s,--source-port}'[source port(s) for scan packets]'
  {-S,--source-ip}'[source address(es) for scan packets]'
  {-G,--gateway-mac}'[specify gateway MAC address]'
  '--source-mac[source MAC address]'
  {-i,--interface}'[specify network interface to use]'
  {-X,--vpn}'[sends IP packets instead of Ethernet (for VPNs)]'
  {-M,--probe-module}'[select probe module (default=`tcp_synscan)]'
  '--probe-args[arguments to pass to probe module]'
  '--list-probe-modules[list available probe modules]'
  {-f,--output-fields}'[fields that should be output in result set]'
  {-O,--output-module}'[select output module (default=`default)]'
  '--output-args[arguments to pass to output module]'
  '--output-filter[specify a filter over the response fields to]'
  '--list-output-modules[list available output modules]'
  '--list-output-fields[list all fields that can be output by selected]'
  {-v,--verbosity}'[level of log detail (0-5) (default=`3)]'
  {-l,--log-file}'[write log entries to file]'
  {-L,--log-directory}'[write log entries to a timestamped file in this]'
  {-m,--metadata-file}'[output file for scan metadata (JSON)]'
  {-u,--status-updates-file}'[write scan progress updates to CSV file]'
  {-q,--quiet}'[do not print status updates]'
  '--disable-syslog[disables logging messages to syslog]'
  '--notes[inject user-specified notes into scan metadata]'
  '--user-metadata[inject user-specified JSON metadata into scan]'
  {-C,--config}'[read a configuration file, which can specify]'
  '--max-sendto-failures[maximum NIC sendto failures before scan is]'
  '--min-hitrate[minimum hitrate that scan can hit before scan]'
  {-T,--sender-threads}'[threads used to send packets (default=`1)]'
  '--cores[comma-separated list of cores to pin to]'
  '--ignore-invalid-hosts[ignore invalid hosts in whitelist/blacklist]'
  '(- * :)'{-h,--help}'[print help and exit]'
  {-V,--version}'[print version and exit]'
  '--output-filter[1 && repeat = 0".]'
  '*:filename:_files'
)

_arguments -s $arguments
