#compdef htdbm

local arguments

arguments=(
  '-b[\[-C cost\] \[-TDBTYPE\] database username password]'
  '-n[\[-C cost\] username]'
  '-nb[\[-C cost\] username password]'
  '-v[\[-C cost\] \[-TDBTYPE\] database username]'
  '-vb[\[-C cost\] \[-TDBTYPE\] database username password]'
  '-x[\[-TDBTYPE\] database username]'
  '-l[\[-TDBTYPE\] database]'
  '-c[create a new database.]'
  '-n[dont update database; display results on stdout.]'
  '-b[use the password from the command line rather than prompting for it.]'
  '-i[read password from stdin without verification (for script usage).]'
  '-m[force MD5 encryption of the password (default).]'
  '-B[force BCRYPT encryption of the password (very secure).]'
  '-C[set the computing time used for the bcrypt algorithm]'
  '-d[force CRYPT encryption of the password (8 chars max, insecure).]'
  '-s[force SHA encryption of the password (insecure).]'
  '-p[do not encrypt the password (plaintext, insecure).]'
  '-T[DBM Type (SDBM|GDBM|DB|default).]'
  '-l[display usernames from database on stdout.]'
  '-v[verify the username/password.]'
  '-x[remove the username record from database.]'
  '-t[the last param is username comment.]'
  '*:filename:_files'
)

_arguments -s $arguments
