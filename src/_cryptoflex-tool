#compdef cryptoflex-tool

local arguments

arguments=(
  {-l,--list-keys}'[lists all keys in a public key file]'
  {-c,--create-key-files}'[creates new RSA key files for <arg> keys]'
  {-P,--create-pin-file}'[creates a new CHV<arg> file]'
  {-g,--generate-key}'[generates a new RSA key pair]'
  {-R,--read-key}'[reads a public key from the card]'
  {-V,--verify-pin}'[verifies CHV1 before issuing commands]'
  {-k,--key-num}'[selects which key number to operate on \[1\]]'
  {-a,--app-df}'[selects the DF to operate in]'
  {-p,--prkey-file}'[private key file]'
  {-u,--pubkey-file}'[public key file]'
  {-e,--exponent}'[the RSA exponent to use in key generation \[3\]]'
  {-m,--modulus-length}'[modulus length to use in key generation \[1024\]]'
  {-r,--reader}'[uses reader <arg>]'
  {-w,--wait}'[wait for card insertion]'
  {-v,--verbose}'[verbose operation. Use several times to enable debug output.]'
  '*:filename:_files'
)

_arguments -s $arguments
