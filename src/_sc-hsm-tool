#compdef sc-hsm-tool

local arguments

arguments=(
  {-X,--initialize}'[initialize token]'
  {-C,--create-dkek-share}'[create DKEK key share and save to <filename>]'
  {-I,--import-dkek-share}'[import DKEK key share <filename>]'
  {-W,--wrap-key}'[wrap key and save to <filename>]'
  {-U,--unwrap-key}'[unwrap key read from <filename>]'
  {-s,--dkek-shares}'[number of DKEK shares \[No DKEK\]]'
  '--so-pin[define security officer PIN (SO-PIN)]'
  '--pin[define user PIN]'
  '--pin-retry[define user PIN retry counter]'
  '--password[define password for DKEK share]'
  '--pwd-shares-threshold[define threshold for number of password shares required for reconstruction]'
  '--pwd-shares-total[define number of password shares]'
  {-i,--key-reference}'[key reference for key wrap/unwrap]'
  {-l,--label}'[token label for --initialize]'
  {-f,--force}'[force replacement of key and certificate]'
  {-r,--reader}'[uses reader number <arg> \[0\]]'
  {-w,--wait}'[wait for a card to be inserted]'
  {-v,--verbose}'[verbose operation. Use several times to enable debug output.]'
  '*:filename:_files'
)

_arguments -s $arguments
