#compdef netsniff-ng

local arguments

arguments=(
  '-i[|-d|--dev|--in <dev|pcap|-> Input source as netdev, pcap or pcap stdin]'
  '-o[|--out <dev|pcap|dir|cfg|-> Output sink as netdev, pcap, directory, trafgen, or stdout]'
  '-C[|--fanout-group <id> Join packet fanout group]'
  '-K[|--fanout-type <type> Apply fanout discipline: hash|lb|cpu|rnd|roll|qm]'
  '-L[|--fanout-opts <opts> Additional fanout options: defrag|roll]'
  '-f[|--filter <bpf-file|-|expr> Use BPF filter from bpfc file/stdin or tcpdump-like expression]'
  '-t[|--type <type> Filter for: host|broadcast|multicast|others|outgoing]'
  '-F[|--interval <size|time> Dump interval if -o is a dir: <num>KiB/MiB/GiB/s/sec/min/hrs]'
  '-R[|--rfraw Capture or inject raw 802.11 frames]'
  '-n[|--num <0|uint> Number of packets until exit (def: 0)]'
  '-P[|--prefix <name> Prefix for pcaps stored in directory]'
  '-T[|--magic <pcap-magic> Pcap magic number/pcap format to store, see -D]'
  '-w[|--cooked Use Linux "cooked" header instead of link header]'
  '-D[|--dump-pcap-types Dump pcap types and magic numbers and quit]'
  '-B[|--dump-bpf Dump generated BPF assembly]'
  '-r[|--rand Randomize packet forwarding order (dev->dev)]'
  '-M[|--no-promisc No promiscuous mode for netdev]'
  '-A[|--no-sock-mem Dont tune core socket memory]'
  '-N[|--no-hwtimestamp Disable hardware time stamping]'
  '-m[|--mmap Mmap(2) pcap file I/O, e.g. for replaying pcaps]'
  '-G[|--sg Scatter/gather pcap file I/O]'
  '-c[|--clrw Use slower read(2)/write(2) I/O]'
  '-S[|--ring-size <size> Specify ring size to: <num>KiB/MiB/GiB]'
  '-k[|--kernel-pull <uint> Kernel pull from user interval in us (def: 10us)]'
  '-J[|--jumbo-support Support replay/fwd 64KB Super Jumbo Frames (def: 2048B)]'
  '-b[|--bind-cpu <cpu> Bind to specific CPU]'
  '-u[|--user <userid> Drop privileges and change to userid]'
  '-g[|--group <groupid> Drop privileges and change to groupid]'
  '-H[|--prio-high Make this high priority process]'
  '-Q[|--notouch-irq Do not touch IRQ CPU affinity of NIC]'
  '-s[|--silent Do not print captured packets]'
  '-q[|--less Print less-verbose packet information]'
  '-X[|--hex Print packet data in hex format]'
  '-l[|--ascii Print human-readable packet data]'
  '-U[|--update Update GeoIP databases]'
  '-V[|--verbose Be more verbose]'
  '-v[|--version Show version and exit]'
  '-h[|--help Guess what?!]'
  '*:filename:_files'
)

_arguments -s $arguments
