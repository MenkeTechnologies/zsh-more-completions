#compdef dumpcap

local arguments

arguments=(
  '-i[name or idx of interface (def: first non-loopback)]'
  '-f[filter> packet filter in libpcap filter syntax]'
  '-s[packet snapshot length (def: appropriate maximum)]'
  '-p[dont capture in promiscuous mode]'
  '-I[capture in monitor mode, if available]'
  '-B[size> size of kernel buffer in MiB (def: 2MiB)]'
  '-y[type> link layer type (def: first appropriate)]'
  '--time-stamp-type[timestamp method for interface]'
  '-D[print list of interfaces and exit]'
  '-L[print list of link-layer types of iface and exit]'
  '--list-time-stamp-types[print list of timestamp types for iface and exit]'
  '-d[print generated BPF code for capture filter]'
  '-k[set channel on wifi interface:]'
  '-S[print statistics for each interface once per second]'
  '-M[for -D, -L, and -S, produce machine-readable output]'
  '-c[count> stop after n packets (def: infinite)]'
  '-a[cond.> ... duration:NUM - stop after NUM seconds]'
  '-w[name of file to save (def: tempfile)]'
  '-g[enable group read access on the output file(s)]'
  '-b[opt.> ... duration:NUM - switch to next file after NUM secs]'
  '-n[use pcapng format instead of pcap (default)]'
  '-P[use libpcap format instead of pcapng]'
  '--capture-comment[add a capture comment to the output file]'
  '-N[maximum number of packets buffered within dumpcap]'
  '-C[maximum number of bytes used for buffering packets]'
  '-t[use a separate thread per interface]'
  '-q[dont report packet capture counts]'
  '-v[print version information and exit]'
  '-h[display this help and exit]'
  '*:filename:_files'
)

_arguments -s $arguments
