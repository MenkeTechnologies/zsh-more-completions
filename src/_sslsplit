#compdef sslsplit

local arguments

arguments=(
  '-c[use CA cert (and key) from pemfile to sign forged certs]'
  '-k[use CA key (and cert) from pemfile to sign forged certs]'
  '-C[use CA chain from pemfile (intermediate and root CA certs)]'
  '-K[use key from pemfile for leaf certs (default: generate)]'
  '-q[use URL as CRL distribution point for all forged certs]'
  '-t[use cert+chain+key PEM files from certdir to target all sites]'
  '-w[write leaf key and only generated certificates to gendir]'
  '-W[write leaf key and all certificates to gendir]'
  '-O[deny all OCSP requests on all proxyspecs]'
  '-P[passthrough SSL connections if they cannot be split because of]'
  '-a[use cert from pemfile when destination requests client certs]'
  '-b[use key from pemfile when destination requests client certs]'
  '-g[use DH group params from pemfile (default: keyfiles or auto)]'
  '-G[use ECDH named curve (default: prime256v1)]'
  '-Z[disable SSL/TLS compression on all connections]'
  '-r[only support one of tls10 tls11 tls12 (default: all)]'
  '-R[disable one of tls10 tls11 tls12 (default: none)]'
  '-s[use the given OpenSSL cipher suite spec (default: ALL:-aNULL)]'
  '-e[specify default NAT engine to use (default: netfilter)]'
  '-E[list available NAT engines and exit]'
  '-u[drop privileges to user (default if run as root: nobody)]'
  '-m[when using -u, override group (default: primary group of user)]'
  '-j[chroot() to jaildir (impacts sni proxyspecs, see manual page)]'
  '-p[write pid to pidfile (default: no pid file)]'
  '-l[connect log: log one line summary per connection to logfile]'
  '-L[content log: full data to file or named pipe (excludes -S/-F)]'
  '-S[content log: full data to separate files in dir (excludes -L/-F)]'
  '-F[content log: full data to sep files with % subst (excl. -L/-S):]'
  '-M[log master keys to logfile in SSLKEYLOGFILE format]'
  '-d[daemon mode: run in background, log error messages to syslog]'
  '-D[debug mode: run in foreground, log debug messages on stderr]'
  '-V[print version information and exit]'
  '-h[print usage information and exit]'
  '*:filename:_files'
)

_arguments -s $arguments
