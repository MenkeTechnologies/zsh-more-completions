#compdef cmsutil

local arguments

arguments=(
  '-C[create a CMS encrypted data message]'
  '-D[decode a CMS message]'
  '-b[decode a batch of files named in infile]'
  '-c[use this detached content]'
  '-n[suppress output of content]'
  '-h[display num levels of CMS message info as email headers]'
  '-k[keep decoded encryption certs in perm cert db]'
  '-E[create a CMS enveloped data message]'
  '-r[... create envelope for these recipients]'
  '-S[create a CMS signed data message]'
  '-G[include a signing time attribute]'
  '-H[use hash (default:SHA256)]'
  '-N[use certificate named "nick" for signing]'
  '-P[include a SMIMECapabilities attribute]'
  '-T[do not include content in CMS message]'
  '-Y[include a EncryptionKeyPreference attribute with cert]'
  '-O[create a CMS signed message containing only certificates]'
  '-d[key/cert database directory (default: ~/.netscape)]'
  '-e[enveloped data message in this file is used for bulk key]'
  '-i[use infile as source of data (default: stdin)]'
  '-o[use outfile as destination of data (default: stdout)]'
  '-p[use password as key db password (default: prompt)]'
  '-f[use password file to set password on all PKCS#11 tokens)]'
  '-u[set type of certificate usage (default: certUsageEmailSigner)]'
  '-v[print debugging information]'
  '*:filename:_files'
)

_arguments -s $arguments
