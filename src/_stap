#compdef stap

local arguments

arguments=(
  {-h,--help}'[show help]'
  {-V,--version}'[show version]'
  '-p[stop after pass NUM 1-5, instead of 5]'
  '-v[add verbosity to all passes]'
  '--vp[}+  add per-pass verbosity \[00000\]]'
  '-k[keep temporary directory]'
  '-u[unoptimized translation]'
  '-w[suppress warnings]'
  '-W[turn warnings into errors]'
  '-g[guru mode]'
  '-P[prologue-searching for function probes]'
  '-b[bulk (percpu file) mode]'
  {-i,--interactive}'[interactive mode]'
  '-s[buffer size in megabytes, instead of 0]'
  '-I[look in DIR for additional .stp script files, in addition to]'
  '-D[VAL  emit macro definition into generated C code]'
  '-B[VAL  pass option to kbuild make]'
  '--modinfo[VAL]'
  '-G[VAL set global variable to value]'
  '-R[look in DIR for runtime, instead of]'
  '-r[cross-compile to kernel with given build tree; or else]'
  '-r[cross-compile to kernel /lib/modules/RELEASE/build, instead of]'
  '-a[cross-compile to given architecture, instead of x86_64]'
  '-m[set probe module name, instead of]'
  '-o[send script output to file, instead of stdout. This supports]'
  '-E[run the SCRIPT in addition to the main script specified]'
  '-c[start the probes, run CMD, and exit when it finishes]'
  '-x[sets target() to PID]'
  '-F[run as on-file flight recorder with -o.]'
  '-S[n\] set maximum of the size and the number of files.]'
  '-d[add unwind/symbol data for OBJECT file]'
  '--ldd[add unwind/symbol data for referenced user-space objects.]'
  '--all-modules[add unwind/symbol data for all loaded kernel objects.]'
  '-t[collect probe timing information]'
  '-T[terminate the script after TIME seconds]'
  '-q[generate information on tapset coverage]'
  '--runtime[set the pass-5 runtime mode, instead of kernel]'
  '--dyninst[shorthand for --runtime=dyninst]'
  '--bpf[shorthand for --runtime=bpf]'
  '--prologue-searching[prologue-searching for function probes]'
  '--privilege[check the script for constructs not allowed at the given privilege level]'
  '--unprivileged[equivalent to --privilege=stapusr]'
  '--compatible[suppress incompatible language/tapset changes beyond VERSION]'
  '--check-version[displays warnings where a syntax element may be]'
  '--skip-badvars[substitute zero for bad context $variables]'
  '--suppress-handler-errors[catch all runtime errors, quietly skip probe handlers]'
  '--use-server[specify systemtap compile-servers]'
  '--list-servers[report on the status of the specified compile-servers:]'
  '--trust-servers[add/revoke trust of specified compile-servers:]'
  '--use-server-on-error[/no\]]'
  '--remote[run pass 5 on the specified ssh host.]'
  '--remote-prefix[prefix each line of remote output with a host index.]'
  '--tmpdir[specify name of temporary directory to be used.]'
  '--download-debuginfo[automatically download debuginfo using ABRT.]'
  '--dump-probe-types[show a list of available probe types.]'
  '--sysroot[specify sysroot directory where target files (executables]'
  '--sysenv[VALUE]'
  '--suppress-time-limits[disable -DSTP_OVERLOAD, -DMAXACTION, and -DMAXTRYACTION limits]'
  '--save-uprobes[save uprobes.ko to current directory if it is built from source]'
  '--target-namesapce[sets the target namespaces pid to PID]'
  '--monitor[enables monitor interfaces]'
  '*:filename:_files'
)

_arguments -s $arguments
