#compdef iperf3-darwin

local arguments

arguments=(
  {-p,--port}'[#         server port to listen on/connect to]'
  {-f,--format}'[\[kmgtKMGT\] format to report: Kbits, Mbits, Gbits, Tbits]'
  {-i,--interval}'[#         seconds between periodic throughput reports]'
  {-F,--file}'[xmit/recv the specified file]'
  {-B,--bind}'[<host>    bind to the interface associated with the address <host>]'
  {-V,--verbose}'[more detailed output]'
  {-J,--json}'[output in JSON format]'
  '--logfile[send output to a log file]'
  '--forceflush[force flushing output at every interval]'
  {-d,--debug}'[emit debugging output]'
  {-v,--version}'[show version information and quit]'
  {-h,--help}'[show this message and quit]'
  {-s,--server}'[run in server mode]'
  {-D,--daemon}'[run the server as a daemon]'
  {-I,--pidfile}'[write PID file]'
  {-1,--one-off}'[handle one client connection then exit]'
  {-c,--client}'[<host>    run in client mode, connecting to <host>]'
  {-u,--udp}'[use UDP rather than TCP]'
  '--connect-timeout[timeout for control connection setup (ms)]'
  {-b,--bitrate}'[/#\]  target bitrate in bits/sec (0 for unlimited)]'
  '--pacing-timer[set the timing for pacing, in microseconds (default 1000)]'
  {-t,--time}'[#         time in seconds to transmit for (default 10 secs)]'
  {-n,--bytes}'[#\[KMG\]    number of bytes to transmit (instead of -t)]'
  {-k,--blockcount}'[number of blocks (packets) to transmit (instead of -t or -n)]'
  {-l,--length}'[#\[KMG\]    length of buffer to read or write]'
  '--cport[<port>    bind to a specific client port (TCP and UDP, default: ephemeral port)]'
  {-P,--parallel}'[#         number of parallel client streams to run]'
  {-R,--reverse}'[run in reverse mode (server sends, client receives)]'
  '--bidir[run in bidirectional mode.]'
  {-w,--window}'[#\[KMG\]    set window size / socket buffer size]'
  {-M,--set-mss}'[#         set TCP/SCTP maximum segment size (MTU - 40 bytes)]'
  {-N,--no-delay}'[set TCP/SCTP no delay, disabling Nagles Algorithm]'
  {-4,--version4}'[only use IPv4]'
  {-6,--version6}'[only use IPv6]'
  {-S,--tos}'[set the IP type of service, 0-255.]'
  '--dscp[or --dscp val    set the IP dscp value, either 0-63 or symbolic.]'
  {-Z,--zerocopy}'[use a zero copy method of sending data]'
  {-O,--omit}'[omit the first n seconds]'
  {-T,--title}'[prefix every output line with this string]'
  '--extra-data[data string to include in client and server JSON]'
  '--get-server-output[get results from server]'
  '--udp-counters-64bit[use 64-bit counters in UDP test packets]'
  '--repeating-payload[use repeating pattern in payload, instead of]'
  '--apple-quic[use QUIC rather than TCP]'
  '--apple-quic-verbose[enable QUIC verbose logging]'
  '--apple-quic-multiplex[when using -P, use multiple streams instead]'
  '--apple-tclass[set the SO_TRAFFIC_CLASS socket option to the class]'
  '--apple-rcvanyif[set the SO_RECV_ANYIF socket option]'
  '--apple-boundif[set the IP\[V6\]_BOUND_IF socket option for the interface name]'
  '--apple-intcoproc[set the SO_INTCOPROC_ALLOW socket option]'
  '--apple-delegate[set the SO_DELEGATED socket option to the process]'
  '--apple-multiscope[set the IP_MULTICAST_IFINDEX socket option for the interface name]'
  '--apple-multicastif[set the IPV6_MULTICAST_IF socket option with the address]'
  '--apple-msgcnt[number of concurrent messages]'
  '--apple-noflowadvisory[boolean to disable flow control advisory for UDP]'
  '--apple-nwconnection[use the nw_connection api]'
  '--apple-nwprotocol[use the nw_protocol api]'
  '--apple-multipathsvc[use MPTCP, with the specified service-type]'
  '--apple-control-host[connect to this host for the control tcp connection only]'
  '--apple-control-port[connect to this port for the control tcp connection only]'
  '--apple-tls[use TLS]'
  '--apple-checksum[compute and report checksum]'
  '--apple-busytime[ms>   only read/write on the client-side for X milliseconds]'
  '--apple-sleeptime[ms>  after each busy-time (see above), sleep for X milliseconds]'
  '--apple-ignore-order[do not emit an error if an out of order packet is received]'
  '--apple-tempdir[path of existing directory to store temporary files]'
  '--apple-proxy[proxy parameter as JSON data]'
  '--apple-proxy[path to file with proxy parameters JSON data]'
  '--apple-l4s[enable L4S on the connection, currently supported only for QUIC]'
  '--sleepatexit[sleep indefinitively at exit (to check for leaks for example)]'
  '*:filename:_files'
)

_arguments -s $arguments
