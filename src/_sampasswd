#compdef sampasswd

local arguments

arguments=(
  '-r[reset users password]'
  '-l[list users in sam]'
  {-r,-u}'[-> resets password of user named theboss if found]'
  {-r,-u}'[3ea -> resets password for user with RID 0x3ea (hex)]'
  {-r,-a}'[-> Reset password of all users in administrators group (0x220)]'
  {-r,-f}'[-> Reset password of admin user with lowest RID]'
  '-H[for list: Human readable listing (default is parsable table)]'
  '-H[for reset: Will output confirmation message if success]'
  '-N[no allocate mode, only allow edit of existing values with same size]'
  '-E[no expand mode, do not expand hive file (safe mode)]'
  '-t[debug trace of allocated blocks]'
  '-v[some more verbose messages/debug]'
  '*:filename:_files'
)

_arguments -s $arguments
