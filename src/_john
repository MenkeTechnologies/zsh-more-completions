#compdef john

local arguments

arguments=(
  '--single["single crack" mode]'
  {--wordlist,--stdin}'[mode, read words from FILE or stdin]'
  '--pipe[like --stdin, but bulk reads, and allows rules]'
  '--loopback[like --wordlist, but fetch words from a .pot file]'
  '--dupe-suppression[suppress all dupes in wordlist (and force preload)]'
  '--prince[PRINCE mode, read words from FILE]'
  '--encoding[input encoding (eg. UTF-8, ISO-8859-1). See also]'
  '--rules[enable word mangling rules for wordlist modes]'
  '--incremental["incremental" mode \[using section MODE\]]'
  '--mask[mask mode using MASK]'
  '--markov["Markov" mode (see doc/MARKOV)]'
  '--external[external mode or word filter]'
  '--stdout[just output candidate passwords \[cut at LENGTH\]]'
  '--restore[restore an interrupted session \[called NAME\]]'
  '--session[give a new session the NAME]'
  '--status[print status of a session \[called NAME\]]'
  '--make-charset[make a charset file. It will be overwritten]'
  '--show[show cracked passwords \[if =LEFT, then uncracked\]]'
  '--test[run tests and benchmarks for TIME seconds each]'
  '--users[..\] \[do not\] load this (these) user(s) only]'
  '--groups[..\] load users \[not\] of this (these) group(s) only]'
  '--shells[..\] load users with\[out\] this (these) shell(s) only]'
  '--salts[load salts with\[out\] COUNT \[to MAX\] hashes]'
  '--save-memory[enable memory saving, at LEVEL 1..3]'
  '--node[/TOTAL this nodes number range out of TOTAL count]'
  '--fork[fork N processes]'
  '--pot[pot file to use]'
  '--list[list capabilities, see --list=help or doc/OPTIONS]'
  '--format[force hash of type NAME. The supported formats can]'
  '*:filename:_files'
)

_arguments -s $arguments
