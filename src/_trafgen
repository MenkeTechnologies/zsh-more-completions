#compdef trafgen

local arguments

arguments=(
  '-i[|-c|--in|--conf <cfg/-> Packet configuration file/stdin]'
  '-o[|-d|--out|--dev <netdev|.cfg|.pcap> Networking device or configuration file i.e., eth0]'
  '-p[|--cpp Run packet config through C preprocessor]'
  '-D[|--define Add macro/define for C preprocessor]'
  '-J[|--jumbo-support Support 64KB super jumbo frames (def: 2048B)]'
  '-R[|--rfraw Inject raw 802.11 frames]'
  '-s[|--smoke-test <ipv4> Probe if machine survived fuzz-tested packet]'
  '-n[|--num <uint> Number of packets until exit (def: 0)]'
  '-r[|--rand Randomize packet selection (def: round robin)]'
  '-P[|--cpus <uint> Specify number of forks(<= CPUs) (def: #CPUs)]'
  '-t[|--gap <time> Set approx. interpacket gap (s/ms/us/ns, def: us)]'
  '-b[|--rate <rate> Send traffic at specified rate (pps/B/kB/MB/GB/kbit/Mbit/Gbit/KiB/MiB/GiB)]'
  '-S[|--ring-size <size> Manually set mmap size (KiB/MiB/GiB)]'
  '-E[|--seed <uint> Manually set srand(3) seed]'
  '-u[|--user <userid> Drop privileges and change to userid]'
  '-g[|--group <groupid> Drop privileges and change to groupid]'
  '-H[|--prio-high Make this high priority process]'
  '-A[|--no-sock-mem Dont tune core socket memory]'
  '-Q[|--notouch-irq Do not touch IRQ CPU affinity of NIC]'
  '-q[|--qdisc-path Enable qdisc kernel path (default off since 3.14)]'
  '-V[|--verbose Be more verbose]'
  '-C[|--no-cpu-stats Do not print CPU time statistics on exit]'
  '-v[|--version Show version and exit]'
  '-e[|--example Show built-in packet config example]'
  '-h[|--help Guess what?!]'
  '*:filename:_files'
)

_arguments -s $arguments
