#compdef sigtool

local arguments

arguments=(
  {--help,-h}'[show this help]'
  {--version,-V}'[print version number and exit]'
  '--quiet[be quiet, output only error messages]'
  '--debug[enable debug messages]'
  '--stdout[write to stdout instead of stderr]'
  '--hex-dump[convert data from stdin to a hex]'
  '--md5[generate MD5 checksum from stdin]'
  '--sha1[generate SHA1 checksum from stdin]'
  '--sha256[generate SHA256 checksum from stdin]'
  '--mdb[generate .mdb (section hash) sigs]'
  '--imp[generate .imp (import table hash) sigs]'
  '--html-normalise[create normalised parts of HTML file]'
  '--ascii-normalise[create normalised text file from ascii source]'
  '--utf16-decode[decode UTF16 encoded files]'
  {--info,-i}'[print database information]'
  '--build[\[cvd\] -b NAME Build a CVD file]'
  '--max-bad-sigs[maximum number of mismatched signatures]'
  '--flevel[specify a custom flevel.]'
  '--cvd-version[specify the version number to use for]'
  '--datadir[version+1 is used and]'
  '--no-cdiff[dont generate .cdiff file]'
  '--unsigned[create unsigned database file (.cud)]'
  '--hybrid[create a hybrid (standard and bytecode) database file]'
  '--print-certs[print Authenticode details from a PE]'
  '--server[clamAV Signing Service address]'
  '--datadir[use DIR as default database directory]'
  {--unpack,-u}'[unpack a CVD/CLD file]'
  '--unpack-current[unpack local CVD/CLD into cwd]'
  {--list-sigs,-l}'[list signature names]'
  {--find-sigs,-fREGEX}'[find signatures matching REGEX]'
  '--decode-sigs[decode signatures from stdin]'
  '--test-sigs[TARGET_FILE Test signatures from DATABASE against]'
  '--vba[extract VBA/Word6 macro code]'
  '--vba-hex[extract Word6 macro code with hex values]'
  '--diff[NEW -d OLD NEW Create diff for OLD and NEW CVDs]'
  '--compare[NEW -c OLD NEW Show diff between OLD and NEW files in]'
  {--run-cdiff,-r}'[execute update script FILE in cwd]'
  '--verify-cdiff[CVD/CLD Verify DIFF against CVD/CLD]'
  '*:filename:_files'
)

_arguments -s $arguments
