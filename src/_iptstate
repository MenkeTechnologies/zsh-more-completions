#compdef iptstate

local arguments

arguments=(
  {-c,--no-color}'[toggle color-code by protocol]'
  {-C,--counters}'[toggle display of bytes/packets counters]'
  {-d,--dst-filter}'[only show states with a destination of <IP>]'
  {-D,--dstpt-filter}'[only show states with a destination port of <port>]'
  '(- * :)'{-h,--help}'[this help message]'
  {-l,--lookup}'[show hostnames instead of IP addresses. Enabling this will also enable]'
  '-L[prevent an ever-growing number of DNS requests.]'
  {-m,--mark-truncated}'[mark truncated hostnames with a +]'
  {-o,--no-dynamic}'[toggle dynamic formatting]'
  {-L,--no-dns}'[skip outgoing DNS lookup states]'
  {-f,--no-loopback}'[filter states on loopback]'
  {-p,--no-scroll}'[no scrolling (dont use a "pad")]'
  {-r,--reverse}'[reverse sort order]'
  {-R,--rate}'[refresh rate, followed by rate in seconds]'
  {-1,--single}'[single run (no curses)]'
  {-b,--sort}'[this determines what column to sort by. Options:]'
  {-s,--src-filter}'[only show states with a source of <IP>]'
  {-S,--srcpt-filter}'[only show states with a source port of <port>]'
  {-t,--totals}'[toggle display of totals]'
  '*:filename:_files'
)

_arguments -s $arguments
