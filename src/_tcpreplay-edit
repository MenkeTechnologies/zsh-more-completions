#compdef tcpreplay-edit

local arguments

arguments=(
  {-r,--portmap}'[rewrite TCP/UDP ports]'
  {-s,--seed}'[randomize src/dst IPv4/v6 addresses w/ given seed]'
  {-N,--pnat}'[rewrite IPv4/v6 addresses using pseudo-NAT]'
  {-S,--srcipmap}'[rewrite source IPv4/v6 addresses using pseudo-NAT]'
  {-D,--dstipmap}'[rewrite destination IPv4/v6 addresses using pseudo-NAT]'
  {-e,--endpoints}'[rewrite IP addresses to be between two endpoints]'
  {-b,--skipbroadcast}'[skip rewriting broadcast/multicast IPv4/v6 addresses]'
  {-C,--fixcsum}'[force recalculation of IPv4/TCP/UDP header checksums]'
  {-m,--mtu}'[override default MTU length (1500 bytes)]'
  '--mtu-trunc[truncate packets larger then specified MTU]'
  {-E,--efcs}'[remove Ethernet checksums (FCS) from end of frames]'
  '--ttl[modify the IPv4/v6 TTL/Hop Limit]'
  '--tos[set the IPv4 TOS/DiffServ/ECN byte]'
  '--tclass[set the IPv6 Traffic Class byte]'
  '--flowlabel[set the IPv6 Flow Label]'
  {-F,--fixlen}'[pad or truncate packet data to match header length]'
  '--fuzz-seed[fuzz 1 in X packets. Edit bytes, length, or emulate packet drop]'
  '--fuzz-factor[set the Fuzz 1 in X packet ratio (default 1 in 8 packets)]'
  '--skipl2broadcast[skip rewriting broadcast/multicast Layer 2 addresses]'
  '--dlt[override output DLT encapsulation]'
  '--enet-dmac[override destination ethernet MAC addresses]'
  '--enet-smac[override source ethernet MAC addresses]'
  '--enet-subsmac[substitute MAC addresses]'
  '--enet-mac-seed[randomize MAC addresses]'
  '--enet-mac-seed-keep-bytes[randomize MAC addresses]'
  '--enet-vlan[specify ethernet 802.1q VLAN tag mode]'
  '--enet-vlan-tag[specify the new ethernet 802.1q VLAN tag value]'
  '--enet-vlan-cfi[specify the ethernet 802.1q VLAN CFI value]'
  '--enet-vlan-pri[specify the ethernet 802.1q VLAN priority]'
  '--hdlc-control[specify HDLC control value]'
  '--hdlc-address[specify HDLC address]'
  '--user-dlt[set output file DLT type]'
  '--user-dlink[rewrite Data-Link layer with user specified data]'
  {-d,--dbug}'[enable debugging output]'
  {-q,--quiet}'[quiet mode]'
  {-T,--timer}'[select packet timing mode: select, ioport, gtod, nano]'
  '--maxsleep[sleep for no more then X milliseconds between packets]'
  {-v,--verbose}'[print decoded packets via tcpdump to STDOUT]'
  {-A,--decode}'[arguments passed to tcpdump decoder]'
  {-K,--preload-pcap}'[preloads packets into RAM before sending]'
  {-c,--cachefile}'[split traffic via a tcpprep cache file]'
  {-2,--dualfile}'[replay two files at a time from a network tap]'
  {-i,--intf1}'[client to server/RX/primary traffic output interface]'
  {-I,--intf2}'[server to client/TX/secondary traffic output interface]'
  '--listnics[list available network interfaces and exit]'
  {-l,--loop}'[loop through the capture file X times]'
  '--loopdelay-ms[delay between loops in milliseconds]'
  '--pktlen[override the snaplen and use the actual packet len]'
  {-L,--limit}'[limit the number of packets to send]'
  '--duration[limit the number of seconds to send]'
  {-x,--multiplier}'[modify replay speed to a given multiple]'
  {-p,--pps}'[replay packets at a given packets/sec]'
  {-M,--mbps}'[replay packets at a given Mbps]'
  {-t,--topspeed}'[replay packets as fast as possible]'
  {-o,--oneatatime}'[replay one packet at a time for each user input]'
  '--pps-multi[number of packets to send for each time interval]'
  '--unique-ip[modify IP addresses each loop iteration to generate unique flows]'
  '--unique-ip-loops[number of times to loop before assigning new unique ip]'
  {-P,--pid}'[print the PID of tcpreplay at startup]'
  {-V,--version}'[print version information]'
  {-h,--less-help}'[display less usage information and exit]'
  {-H,--help}'[display extended usage information and exit]'
  '*:filename:_files'
)

_arguments -s $arguments
