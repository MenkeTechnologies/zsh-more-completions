#compdef radsniff

local arguments

arguments=(
  '-a[list all interfaces available for capture.]'
  '-c[number of packets to capture.]'
  '-C[enable UDP checksum validation.]'
  '-d[set dictionary directory.]'
  '-d[set configuration directory (defaults to /etc/freeradius/3.0).]'
  '-D[set main dictionary directory (defaults to /usr/share/freeradius).]'
  '-e[<event>\] Only log requests with these event flags.]'
  '-f[PCAP filter (default is udp port <port> or <port + 1> or 3799)]'
  '-h[this help message.]'
  '-i[capture packets from interface (defaults to all if supported).]'
  '-I[read packets from file (overrides input of -F).]'
  '-l[<attr>\] Output packet sig and a list of attributes.]'
  '-L[<attr>\] Detect retransmissions using these attributes to link requests.]'
  '-m[dont put interface(s) into promiscuous mode.]'
  '-p[filter packets by port (default is 1812).]'
  '-P[daemonize and write out <pidfile>.]'
  '-q[print less debugging information.]'
  '-r[RADIUS attribute request filter.]'
  '-R[RADIUS attribute response filter.]'
  '-s[RADIUS secret.]'
  '-S[write PCAP data to stdout.]'
  '-v[show program version information.]'
  '-w[write output packets to file.]'
  '-x[print more debugging information.]'
  '-W[periodically write out statistics every <interval> seconds.]'
  '-T[how many milliseconds before the request is counted as lost (defaults to 5200).]'
  '-N[the instance name passed to the collectd plugin.]'
  '-O[write statistics to this collectd server.]'
  '*:filename:_files'
)

_arguments -s $arguments
